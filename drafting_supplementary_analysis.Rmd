---
title: "Supplementary Analyses"
author: "Mariola Paruzel-Czachura, Cillian McHugh"
date: "`r format(Sys.time(), '%d %B, %Y')`"
bibliography: "resources/bib/My Library.bib"
csl: "resources/bib/apa.csl"
output:
  bookdown::html_document2:
    fig_caption: yes
    toc: true
    toc_float:
      toc_collapsed: false
    toc_depth: 4
    number_sections: false
editor_options: 
  chunk_output_type: console
---

<style>
  .superbigimage{
      overflow-x:scroll;
      white-space: nowrap;
  }

  .superbigimage img{
     max-width: none;
  }


</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
```


```{r}
rm(list = ls())
library(tidyverse)
library(plyr)
library(psych)
library(skimr)
library(corrplot)
library(Hmisc)
#library(psy)
library(afex)
#devtools::install_github("cillianmiltown/R_desnum")
library(desnum)
library(papaja)
library(purrr)
#install.packages("interactions")
library(interactions)
library(kableExtra)
#devtools::install_github("crsh/papaja")
library("papaja")
library(lme4)
library(car)
library(ggplot2)
library(nlme)
#install.packages("reshape")
library(reshape)
library(corx)
library(lsr)
#install.packages("Cairo")
#library(Cairo)
library(foreign)
library(ltm)
library("ggpubr")
#install.packages("rworldmap")
library(rworldmap)
#devtools::install_github("rensa/ggflags")
library(ggflags)
#devtools::install_github("schliebs/ggoxford")
library(ggoxford)
library(ggforce)
library(ggbeeswarm)
library(countrycode)
```

```{r}

#source("set_up_data_calculate_means.R")
load("data/data_with_means.RData")

df$sex3 <- as.factor(df$sex1)
df$sex3 <- dplyr::recode(df$sex3,
               "1"="male"
              ,"2"="female"
              ,"3"="other")

df$country_lower <- tolower(df$country)
df$country_name <- countrycode(df$ISO3, origin = "iso3c", destination = "country.name")
```


# H1 Gender Differences

## Internalization 

```{r}

ps <- function(y){
  y <- round(y, digits = 3)
  if(as.numeric(sqrt( y*y) ) <.001) print(paste0("<", " ", ".001","**"), quote = FALSE)
  else if(as.numeric(sqrt( y*y) ) <.05) print(paste0(sub("^(-?)0.", "\\1.", sprintf("%.3f", 
        y, quote = FALSE)),"*"))
  else print(sub("^(-?)0.", "\\1.", sprintf("%.3f", 
        y)))}

#### ensure correct data is loaded ####
x <- df[which(df$sex3=="male"|df$sex3=="female"),]
x$sex3 <- droplevels(x$sex3)

#### remove any missing data #### 
sum(is.na(x$moral_identity_internal))
x <- x[which(is.na(x$moral_identity_internal)==FALSE),]
table(x$country_name,x$sex3)
x$country_name

#### group by country ####
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )

#### identify countries with small samples
male_length <- function(x){sum(x$sex3=='male')}
males <- lapply(x, male_length)
female_length <- function(x){sum(x$sex3=='female')}
females <- lapply(x, female_length)
names(females)

#### generate a vector containing all countries with less than 10 observations for either males or females ####
exclusions <- c(names(males[males<2]),
  names(females[females<2]))

#### re-load ungrouped data ####
x <- df[which(df$sex3=="male"|df$sex3=="female"),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_internal))
x <- x[which(is.na(x$moral_identity_internal)==FALSE),]

#### Filter out any countries to be excluded ####
x <- subset(x, !(country_name %in% exclusions))

#### group by country for analysis ####
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )

ttest_fun <- function(x){
  t.test(moral_identity_internal ~ sex3, data = x)
}
all_t_tests <- lapply(x, ttest_fun)

# Means and Standard Deviations
means_fun <- function(x){
  mean(x$moral_identity_internal)
}
lapply(x, means_fun)
sd_fun <- function(x){
  sd(x$moral_identity_internal)
}
lapply(x, sd_fun)

N_fun <- function(x){
  length(x$sex3)
}
total_Ns <- lapply(x, N_fun)

# Statistics for table
# Cohen's d
cohens_d_fun <- function(x){
  cohen.d(x$moral_identity_symbolic, x$sex3)
}
all_ds <- lapply(x, cohens_d_fun)
show_d_fun <- function(x){
  x$cohen.d[2]
}
ds_for_table <- lapply(all_ds, show_d_fun)

# t statistic
all_t_stats <- function(t){
  t$statistic
}
ts_for_table <- lapply(all_t_tests, all_t_stats)

# df
all_t_df <- function(t){
  t$parameter
}
df_for_table <- lapply(all_t_tests, all_t_df)

# p value
all_t_ps <- function(t){
  t$p.value
}
ps_for_table <- lapply((lapply(all_t_tests, all_t_ps)), ps)

sum(unlist(lapply(all_t_tests, all_t_ps))<.05)

#### means for Males ####
# re-load ungrouped data #
x <- df[which(df$sex3=="male"
              #|df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_internal))
x <- x[which(is.na(x$moral_identity_internal)==FALSE),]
x <- subset(x, !(country_name %in% exclusions))


x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
male_means <- lapply(x, means_fun)
male_sds <- lapply(x, sd_fun)
male_Ns <- lapply(x, N_fun)

#### means for Females
# re-load ungrouped data #
x <- df[which(df$sex3=="female"
              #|df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_internal))
x <- x[which(is.na(x$moral_identity_internal)==FALSE),]
x <- subset(x, !(country_name %in% exclusions))

x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
female_means <- lapply(x, means_fun)
female_sds <- lapply(x, sd_fun)
female_Ns <- lapply(x, N_fun)


```

### Internalization Ns


```{r}
#### Total Ns
x <- df[which(df$sex3=="male"
              |df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_internal))
x <- x[which(is.na(x$moral_identity_internal)==FALSE),]
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
total_Ns <- lapply(x, N_fun)

#### Ns for Males 
# re-load ungrouped data #
x <- df[which(df$sex3=="male"
              #|df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_internal))
x <- x[which(is.na(x$moral_identity_internal)==FALSE),]
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
male_Ns <- lapply(x, N_fun)

#### Ns for Females
# re-load ungrouped data #
x <- df[which(df$sex3=="female"
              #|df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)
# and remove missing again
sum(is.na(x$moral_identity_internal))
x <- x[which(is.na(x$moral_identity_internal)==FALSE),]
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
female_Ns <- lapply(x, N_fun)

test <- 
  cbind.data.frame(do.call(rbind, total_Ns)
                 ,do.call(rbind, female_Ns)
                 ,do.call(rbind, male_Ns))

test <- `colnames<-`(test, c("Total N","n Female","N male"))

loop_exclusions_fun <- function(x){
  if(rownames(test)[x] %in% exclusions) print(paste0(rownames(test)[x],"*"),quote = FALSE)
  else print(rownames(test)[x])
  }

rownames(test) <-  unlist(lapply(1:length(rownames(test)), loop_exclusions_fun))
test
test <- test[order(rownames(test) ),]

```

```{r include=TRUE}

apa_table(
  test
  , align = c("c", "c", "c")
  , caption = "Total samples for each country for Internalization analysis"
  , note = "* = sample too small to be included in analysis below")


```

### Internalization Table

```{r}

test <- 
  cbind.data.frame(
     round(do.call(rbind, female_means),digits=2)
    ,round(do.call(rbind, female_sds),digits=2)
    ,round(do.call(rbind, male_means),digits=2)
    ,round(do.call(rbind, female_sds),digits=2)
    ,round(do.call(rbind, ts_for_table),digits=2)
    ,round(do.call(rbind, df_for_table),digits=2)
    ,do.call(rbind, ps_for_table)
    ,round(do.call(rbind, ds_for_table),digits=2)
    )

test <- `colnames<-`(test, c("mean F","SD F","mean M", "SD M", "t","df","p","d"))
test

x <- df[which(df$sex3=="male"
              |df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_internal))
x <- x[which(is.na(x$moral_identity_internal)==FALSE),]
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
total_Ns <- lapply(x, N_fun)

P_R <- x$`Puerto Rico`
P_R <- 
  `rownames<-`(
    `colnames<-`(
      as.data.frame(
        rbind(
          # c("mean F","SD F","mean M", "SD M", "t","df","p","d")
          # ,
          c(
            P_R$moral_identity_internal[which(P_R$sex3=="male")]
            ,"-"
            ,P_R$moral_identity_internal[which(P_R$sex3=="female")]
            ,"-"
            ,"-"
            ,"-"
            ,"-"
            ,"-"))),
      c("mean F","SD F","mean M", "SD M", "t","df","p","d"))
    ,c("Peurto Rico"))

test <- rbind(test[1:49,],P_R,test[50:length(test$`mean F`),])
test <- test[order(rownames(test) ),]

```

```{r include=TRUE}

apa_table(
  test
  , align = c("l", "l", "c", "c", "c", "c", "c", "c", "c", "c")
  , caption = "Gender differences in Internalization for each Country"
  , note = "* = sig. at p < .05; ** = sig. at p < .001")


```


## Symbolization



```{r}

ps <- function(y){
  y <- round(y, digits = 3)
  if(as.numeric(sqrt( y*y) ) <.001) print(paste0("<", " ", ".001","**"), quote = FALSE)
  else if(as.numeric(sqrt( y*y) ) <.05) print(paste0(sub("^(-?)0.", "\\1.", sprintf("%.3f", 
        y, quote = FALSE)),"*"))
  else print(sub("^(-?)0.", "\\1.", sprintf("%.3f", 
        y)))}

#### ensure correct data is loaded ####
x <- df[which(df$sex3=="male"|df$sex3=="female"),]
x$sex3 <- droplevels(x$sex3)

#### remove any missing data #### 
sum(is.na(x$moral_identity_symbolic))
x <- x[which(is.na(x$moral_identity_symbolic)==FALSE),]
table(x$country_name,x$sex3)
x$country_name

#### group by country ####
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )

#### identify countries with small samples
male_length <- function(x){sum(x$sex3=='male')}
males <- lapply(x, male_length)
female_length <- function(x){sum(x$sex3=='female')}
females <- lapply(x, female_length)
names(females)

#### generate a vector containing all countries with less than 10 observations for either males or females ####
exclusions <- c(names(males[males<2]),
  names(females[females<2]))

#### re-load ungrouped data ####
x <- df[which(df$sex3=="male"|df$sex3=="female"),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_symbolic))
x <- x[which(is.na(x$moral_identity_symbolic)==FALSE),]

#### Filter out any countries to be excluded ####
x <- subset(x, !(country_name %in% exclusions))

#### group by country for analysis ####
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )

ttest_fun <- function(x){
  t.test(moral_identity_symbolic ~ sex3, data = x)
}
all_t_tests <- lapply(x, ttest_fun)

means_fun <- function(x){
  mean(x$moral_identity_symbolic)
}
lapply(x, means_fun)
sd_fun <- function(x){
  sd(x$moral_identity_symbolic)
}
lapply(x, sd_fun)

cohens_d_fun <- function(x){
  cohen.d(x$moral_identity_symbolic, x$sex3)
}
all_ds <- lapply(x, cohens_d_fun)
show_d_fun <- function(x){
  x$cohen.d[2]
}
ds_for_table <- lapply(all_ds, show_d_fun)

all_t_stats <- function(t){
  t$statistic
}
ts_for_table <- lapply(all_t_tests, all_t_stats)

all_t_df <- function(t){
  t$parameter
}
df_for_table <- lapply(all_t_tests, all_t_df)

all_t_ps <- function(t){
  t$p.value
}
ps_for_table <- lapply((lapply(all_t_tests, all_t_ps)), ps)


total_sig <- sum(unlist(lapply(all_t_tests, all_t_ps))<.05)

#### means for Males ####
# re-load ungrouped data #
x <- df[which(df$sex3=="male"
              #|df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_symbolic))
x <- x[which(is.na(x$moral_identity_symbolic)==FALSE),]
x <- subset(x, !(country_name %in% exclusions))


x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
male_means <- lapply(x, means_fun)
male_sds <- lapply(x, sd_fun)

#### means for Females
# re-load ungrouped data #
x <- df[which(df$sex3=="female"
              #|df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_symbolic))
x <- x[which(is.na(x$moral_identity_symbolic)==FALSE),]
x <- subset(x, !(country_name %in% exclusions))


x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
female_means <- lapply(x, means_fun)
female_sds <- lapply(x, sd_fun)

```

### Symbolization Ns


```{r}
#### Total Ns
x <- df[which(df$sex3=="male"
              |df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_symbolic))
x <- x[which(is.na(x$moral_identity_symbolic)==FALSE),]
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
total_Ns <- lapply(x, N_fun)

#### Ns for Males 
# re-load ungrouped data #
x <- df[which(df$sex3=="male"
              #|df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_symbolic))
x <- x[which(is.na(x$moral_identity_symbolic)==FALSE),]
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
male_Ns <- lapply(x, N_fun)

#### Ns for Females
# re-load ungrouped data #
x <- df[which(df$sex3=="female"
              #|df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)
# and remove missing again
sum(is.na(x$moral_identity_symbolic))
x <- x[which(is.na(x$moral_identity_symbolic)==FALSE),]
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
female_Ns <- lapply(x, N_fun)

test <- 
  cbind.data.frame(do.call(rbind, total_Ns)
                 ,do.call(rbind, female_Ns)
                 ,do.call(rbind, male_Ns))

test <- `colnames<-`(test, c("Total N","n Female","N male"))

loop_exclusions_fun <- function(x){
  if(rownames(test)[x] %in% exclusions) print(paste0(rownames(test)[x],"*"),quote = FALSE)
  else print(rownames(test)[x])
  }

rownames(test) <-  unlist(lapply(1:length(rownames(test)), loop_exclusions_fun))
test
test <- test[order(rownames(test) ),]

```

```{r include=TRUE}

apa_table(
  test
  , align = c("c", "c", "c")
  , caption = "Total samples for each country for Symbolization analysis"
  , note = "* = sample too small to be included in analysis below")


```


### Symbolization Table

```{r}

test <- 
  cbind.data.frame(
     round(do.call(rbind, female_means),digits=2)
    ,round(do.call(rbind, female_sds),digits=2)
    ,round(do.call(rbind, male_means),digits=2)
    ,round(do.call(rbind, female_sds),digits=2)
    ,round(do.call(rbind, ts_for_table),digits=2)
    ,round(do.call(rbind, df_for_table),digits=2)
    ,do.call(rbind, ps_for_table)
    ,round(do.call(rbind, ds_for_table),digits=2)
    )

test <- `colnames<-`(test, c("mean F","SD F","mean M", "SD M", "t","df","p","d"))
test

x <- df[which(df$sex3=="male"
              |df$sex3=="female"
              ),]
x$sex3 <- droplevels(x$sex3)

# and remove missing again
sum(is.na(x$moral_identity_symbolic))
x <- x[which(is.na(x$moral_identity_symbolic)==FALSE),]
x <- x %>% group_by(country_name) %>% do(data = (.)) %>% with( set_names(data, country_name) )
total_Ns <- lapply(x, N_fun)

P_R <- x$`Puerto Rico`
P_R <- 
  `rownames<-`(
    `colnames<-`(
      as.data.frame(
        rbind(
          # c("mean F","SD F","mean M", "SD M", "t","df","p","d")
          # ,
          c(
            P_R$moral_identity_symbolic[which(P_R$sex3=="male")]
            ,"-"
            ,P_R$moral_identity_symbolic[which(P_R$sex3=="female")]
            ,"-"
            ,"-"
            ,"-"
            ,"-"
            ,"-"))),
      c("mean F","SD F","mean M", "SD M", "t","df","p","d"))
    ,c("Peurto Rico"))

test <- rbind(test[1:49,],P_R,test[50:length(test$`mean F`),])
test <- test[order(rownames(test) ),]

```

```{r include=TRUE}

apa_table(
  test
  , align = c("l", "l", "c", "c", "c", "c", "c", "c", "c", "c")
  , caption = "Gender differences in Symbolization for each Country"
  , note = "* = sig. at p < .05; ** = sig. at p < .001")


```



# Overview

# Testing for Country Effects

## Internalization


```{r}

# start building the model
## first test if country should be included

# no country
interceptOnly <-gls(moral_identity_internal ~ 1
                    , data = df
                    , method = "ML"
                    , na.action = na.exclude)
summary(interceptOnly)

# country included
randomInterceptOnly <-lme(moral_identity_internal ~ 1
                          , data = df
                          , random = ~1|country
                          , method = "ML"
                          , na.action = na.exclude)
summary(randomInterceptOnly)

LL_d <- logLik(interceptOnly)*-2 - logLik(randomInterceptOnly)*-2
aov <- anova(interceptOnly, randomInterceptOnly)
country_p <- aov$`p-value`[2]



```


Initial testing revealed that for Internalization, allowing intercepts to vary with Country significantly improved the predictive power of the model $\chi$^2^(`r round(aov$df[2]-aov$df[1], digits=2)`) = `r round(aov$L.Ratio[2],digits=2)`, *p* `r paste(p_report(country_p))`.

```{r}
test <- 
  do.call(
    rbind,
    tapply(df$moral_identity_internal, df$ISO3, descriptives)
    )

descriptives(df$moral_identity_internal)

test[order(-test$mean), ]
country_order <- rownames(test[order(-test$mean), ])
```

```{r, internalizationCountry, include=TRUE}
apa_table(
  test
  , caption = "Internalization basic descriptives by Country")
```


```{r}
# https://www.r-bloggers.com/2019/03/all-around-the-world-maps-and-flags-in-r/
df$flag_location <- rep(-1)

test1 <- test[order(-test$mean), ]
test1$country1 <- rownames(test1)
test1$position <- c(11:(10+length(test1$country1)))
test1$ISO3 <- test1$country1
test1$position_country <- paste0(test1$position,test1$country1)
df1 <- left_join(df, test1, by = "ISO3")
```

```{r}

g <- ggplot(df1,aes(x=position_country,y=moral_identity_internal))+
  #geom_violin() +
  stat_summary(fun=mean, geom="point", shape=23, size=2)+
  geom_boxplot(width=0.1, outlier.shape = NA)+
  xlab("Country")+
  ylab("Internalization")+
  geom_jitter(shape=16, position=position_jitter(0.15), size=.1, color="dark grey")+
  geom_axis_flags(breaks = df1$position_country,
                   labels = df1$ISO3,
                   country_icons = df1$ISO3,
                   axis = "x",
                    width = 20,
                   # lineheight = 2,
                   # fontface = "bold"
  )
```


<div class=superbigimage>
```{r, meanInternalization,include=TRUE,fig.width=20,fig.height=6}
suppressWarnings(print(g))

```

</div>
## Symbolization


```{r}
# 
# # start building the model
# ## first test if country should be included
# 
# # no country
# interceptOnly <-gls(moral_identity_symbolic ~ 1
#                     , data = df
#                     , method = "ML"
#                     , na.action = na.exclude)
# summary(interceptOnly)
# 
# # country included
# randomInterceptOnly <-lme(moral_identity_symbolic ~ 1
#                           , data = df
#                           , random = ~1|country
#                           , method = "ML"
#                           , na.action = na.exclude)
# summary(randomInterceptOnly)
# 
# LL_d <- logLik(interceptOnly)*-2 - logLik(randomInterceptOnly)*-2
# aov <- anova(interceptOnly, randomInterceptOnly)
# country_p <- aov$`p-value`[2]



```



Initial testing revealed that for Symbolization, allowing intercepts to vary with Country significantly improved the predictive power of the model $\chi$^2^(`r round(aov$df[2]-aov$df[1], digits=2)`) = `r round(aov$L.Ratio[2],digits=2)`, *p* `r paste(p_report(country_p))`.



```{r}
test <- 
  do.call(
    rbind,
    tapply(df$moral_identity_symbolic, df$ISO3, descriptives)
    )

descriptives(df$moral_identity_symbolic)

test[order(-test$mean), ]
country_order <- rownames(test[order(-test$mean), ])
```

```{r, symbolizationCountry, include=TRUE}
apa_table(
  test
  , caption = "Symbolization basic descriptives by Country")
```


```{r}
# https://www.r-bloggers.com/2019/03/all-around-the-world-maps-and-flags-in-r/
df$flag_location <- rep(-1)

test1 <- test[order(-test$mean), ]
test1$country1 <- rownames(test1)
test1$position <- c(11:(10+length(test1$country1)))
test1$ISO3 <- test1$country1
test1$position_country <- paste0(test1$position,test1$country1)
df1 <- left_join(df, test1, by = "ISO3")
```

```{r}

g <- ggplot(df1,aes(x=position_country,y=moral_identity_symbolic))+
  #geom_violin() +
  stat_summary(fun=mean, geom="point", shape=23, size=2)+
  geom_boxplot(width=0.1, outlier.shape = NA)+
  xlab("Country")+
  ylab("Symbolization")+
  geom_jitter(shape=16, position=position_jitter(0.15), size=.1, color="dark grey")+
  geom_axis_flags(breaks = df1$position_country,
                   labels = df1$ISO3,
                   country_icons = df1$ISO3,
                   axis = "x",
                    width = 20,
                   # lineheight = 2,
                   # fontface = "bold"
  )
```


<div class=superbigimage>
```{r, meanSymbolization,include=TRUE,fig.width=20,fig.height=6}
suppressWarnings(print(g))

```

</div>

# Gender Differences

```{r}
test <- 
  do.call(
    rbind,
    tapply(df$moral_identity_internal, df$sex3, descriptives)
    )

descriptives(df$moral_identity_internal)

test[order(-test$mean), ]
country_order <- rownames(test[order(-test$mean), ])
```

```{r, internalizationgender, include=TRUE}
apa_table(
  test
  , caption = "Internalization basic descriptives by Gender")
```



```{r}
df1 <- df
g <- ggplot(df1,aes(x=sex3,y=moral_identity_internal))+
  geom_violin() +
  #ggforce::geom_sina(size=.01)+
  stat_summary(fun=mean, geom="point", shape=23, size=2)+
  geom_boxplot(width=0.1, outlier.shape = NA)+
  xlab("Gender")+
  ylab("Internalization")+  
  geom_jitter(shape=16, position=position_jitter(height = .5, width = .45), size=.01, color="dark grey")
  
g
```


```{r, meanInternalizationGender,include=TRUE}
suppressWarnings(print(g))

```


```{r}
test <- 
  do.call(
    rbind,
    tapply(df$moral_identity_symbolic, df$sex3, descriptives)
    )

descriptives(df$moral_identity_symbolic)

test[order(-test$mean), ]
country_order <- rownames(test[order(-test$mean), ])
```

```{r, symbolizationgender, include=TRUE}
apa_table(
  test
  , caption = "Symbolization basic descriptives by Gender")
```



```{r}
df1 <- df
g <- ggplot(df1,aes(x=sex3,y=moral_identity_symbolic))+
  geom_violin() +
  #ggforce::geom_sina(size=.01)+
  stat_summary(fun=mean, geom="point", shape=23, size=2)+
  geom_boxplot(width=0.1, outlier.shape = NA)+
  xlab("Gender")+
  ylab("Symbolization")+  
  geom_jitter(shape=16, position=position_jitter(height = .5, width = .45), size=.01, color="dark grey")
  
g
```


```{r, meanSymbolizationGender,include=TRUE}
suppressWarnings(print(g))

```


# Predictors (Individual Level Only)

## Internalization
```{r}
x <- df[which(df$sex3=="male"|df$sex3=="female"),]
x$sex3 <- droplevels(x$sex3)

```


```{r, include=TRUE, echo=TRUE}


model1 <- lmerTest::lmer(moral_identity_internal ~
                    sex3
                  * age
                  + (1|country)
                , data = x
                , contrasts = list(sex3 = contr.sum, valence = contr.sum )
            )
summary(model1)
anova(model1)

```


## Symbolization
```{r}
x <- df[which(df$sex3=="male"|df$sex3=="female"),]
x$sex3 <- droplevels(x$sex3)
```


```{r, include=TRUE, echo=TRUE}


model1 <- lmerTest::lmer(moral_identity_symbolic ~
                    sex3
                  * age
                  + (1|country)
                , data = x
                , contrasts = list(sex3 = contr.sum, valence = contr.sum )
            )
summary(model1)
anova(model1)

```


# Predictors (Cultural Variables Included)

## Internalization
```{r}
x <- df[which(df$sex3=="male"|df$sex3=="female"),]
x$sex3 <- droplevels(x$sex3)
```


```{r, include=TRUE, echo=TRUE}


model1 <- lmerTest::lmer(moral_identity_internal ~
                    sex3
                    * (age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG)
                  + (1|country)
                , data = x
                , contrasts = list(sex3 = contr.sum, valence = contr.sum )
            )
summary(model1)
anova(model1)

```

#### (Regular Regression)

We also ran a regression without allowing slopes to vary by country. Results are below:

```{r, include=TRUE, echo=TRUE}

fit <- lm(moral_identity_internal ~
                    sex3
                    + age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                , data = x
            )

summary(fit)

```


## Symbolization
```{r}
x <- df[which(df$sex3=="male"|df$sex3=="female"),]
x$sex3 <- droplevels(x$sex3)
```


```{r, include=TRUE, echo=TRUE}


model1 <- lmerTest::lmer(moral_identity_symbolic ~
                    sex3
                    * (age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG)
                  + (1|country)
                , data = x
                , contrasts = list(sex3 = contr.sum, valence = contr.sum )
            )
summary(model1)
anova(model1)

```

#### (Regular Regression)

We also ran a regression without allowing slopes to vary by country. Results are below:

```{r, include=TRUE, echo=TRUE}

fit <- lm(moral_identity_symbolic ~
                    sex3
                    + age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                , data = x
            )

summary(fit)


```



# Men and Women Separately

## Men
### Internalization
```{r}
x <- df[
  which(
    df$sex3=="male"
        # |
        #   df$sex3=="female"
          ),]

x$sex3 <- droplevels(x$sex3)
```


```{r, include=TRUE, echo=TRUE}


model1 <- lmerTest::lmer(moral_identity_internal ~
                    age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                  + (1|country)
                , data = x
                , contrasts = list(sex3 = contr.sum, valence = contr.sum )
            )
summary(model1)
anova(model1)
```

#### (Regular Regression)

We also ran a regression without allowing slopes to vary by country. Results are below:

```{r, include=TRUE, echo=TRUE}

fit <- lm(moral_identity_internal ~
                    age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                , data = x
            )

summary(fit)

```


### Symbolization
```{r}
x <- df[
  which(
    df$sex3=="male"
        # |
        #   df$sex3=="female"
          ),]

x$sex3 <- droplevels(x$sex3)
```


```{r, include=TRUE, echo=TRUE}


model1 <- lmerTest::lmer(moral_identity_symbolic ~
                    age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                  + (1|country)
                , data = x
                , contrasts = list(sex3 = contr.sum, valence = contr.sum )
            )
summary(model1)
anova(model1)
```

#### (Regular Regression)

We also ran a regression without allowing slopes to vary by country. Results are below:

```{r, include=TRUE, echo=TRUE}

fit <- lm(moral_identity_symbolic ~
                    age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                , data = x
            )

summary(fit)

```



## Women
### Internalization

```{r}
x <- df[
  which(
    # df$sex3=="male"
    #     |
          df$sex3=="female"
          ),]

x$sex3 <- droplevels(x$sex3)
```


```{r, include=TRUE, echo=TRUE}


model1 <- lmerTest::lmer(moral_identity_internal ~
                    age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                  + (1|country)
                , data = x
                , contrasts = list(sex3 = contr.sum, valence = contr.sum )
            )
summary(model1)
anova(model1)

```

#### (Regular Regression)

We also ran a regression without allowing slopes to vary by country. Results are below:

```{r, include=TRUE, echo=TRUE}


fit <- lm(moral_identity_internal ~
                    age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                , data = x
            )

summary(fit)

```


### Symbolization
```{r}
x <- df[
  which(
    # df$sex3=="male"
    #     |
          df$sex3=="female"
          ),]

x$sex3 <- droplevels(x$sex3)
```


```{r, include=TRUE, echo=TRUE}


model1 <- lmerTest::lmer(moral_identity_symbolic ~
                    age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                  + (1|country)
                , data = x
                , contrasts = list(sex3 = contr.sum, valence = contr.sum )
            )
summary(model1)
anova(model1)

```

#### (Regular Regression)

We also ran a regression without allowing slopes to vary by country. Results are below:

```{r, include=TRUE, echo=TRUE}

fit <- lm(moral_identity_symbolic ~
                    age
                    + Power.Distance
                    + Individualism
                    + Masculinity
                    + Uncertainty.Avoidance
                    + Long.Term.Orientation
                    + Indulgence
                    + CTL_C
                    + CTL_DS
                    + CTL_DG
                , data = x
            )

summary(fit)

```
